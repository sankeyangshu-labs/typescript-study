## å‰è¨€

Helloï¼Œå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸‰æ£µæ¨æ ‘~

æ¬¢è¿é˜…è¯» **TypeScript ä»é›¶å¼€å§‹** ç³»åˆ—æ–‡ç« ç¬¬äº”ç¯‡ï¼åœ¨å‰å‡ ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†è®²è§£äº† TypeScript çš„åŸºç¡€ç±»å‹ã€æ³›å‹ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚éšç€ä»£ç å¤æ‚åº¦çš„æé«˜ï¼Œæˆ‘ä»¬éš¾å…ä¼šé‡åˆ°éœ€è¦æ ¹æ®ç±»å‹åŠ¨æ€ç”Ÿæˆæ–°ç±»å‹çš„åœºæ™¯ï¼Œè€Œè¿™æ­£æ˜¯æ¡ä»¶ç±»å‹å’Œæ˜ å°„ç±»å‹çš„ç”¨æ­¦ä¹‹åœ°ã€‚

æœ¬ç¯‡æ–‡ç« å°†é‡ç‚¹ä»‹ç»æ¡ä»¶ç±»å‹ä¸æ˜ å°„ç±»å‹çš„æ¦‚å¿µå’Œä½¿ç”¨åœºæ™¯ï¼Œå¸®åŠ©æ‚¨æ›´çµæ´»åœ°æ“ä½œå’Œè½¬æ¢ç±»å‹ã€‚

è®©æˆ‘ä»¬å¼€å§‹æˆ‘ä»¬çš„ TS å­¦ä¹ ä¹‹æ—…å§ï¼

## æ¡ä»¶ç±»å‹

æ¡ä»¶ç±»å‹æ˜¯ TypeScript ä¸­çš„ä¸€ç§é«˜çº§ç±»å‹æ„é€ æ–¹å¼ï¼Œå…è®¸æ ¹æ®ç±»å‹å…³ç³»é€‰æ‹©ä¸åŒçš„ç±»å‹ã€‚å®ƒçš„è¯­æ³•ç±»ä¼¼äº JavaScript çš„ä¸‰å…ƒæ¡ä»¶è¡¨è¾¾å¼ã€‚

```typescript
// åŸºæœ¬è¯­æ³•
T extends U ? X : Y
```

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ¡ä»¶ç±»å‹ç¤ºä¾‹ï¼Œç”¨æ¥åˆ¤æ–­æŸä¸ªç±»å‹æ˜¯å¦ä¸º `string` ï¼š

```typescript
type IsString<T> = T extends string ? 'yes' : 'no';

type A = IsString<string>; // 'yes'
type B = IsString<number>; // 'no'
```

è®©æˆ‘ä»¬æ¥å®é™…åº”ç”¨ä¸€ä¸‹æ¡ä»¶ç±»å‹ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥å†™å…¥ç”¨æˆ·å§“åæˆ–å¹´é¾„ã€‚æˆ‘ä»¬æƒ³å®ç°è¿™æ ·çš„ä¸€ä¸ªæ•ˆæœï¼Œå½“æˆ‘ä»¬ä¼ å…¥çš„å€¼ä¸º `string` çš„æ—¶å€™ï¼Œå°±å†™å…¥åˆ°ç”¨æˆ·å§“åï¼›å¦‚æœä¼ å…¥çš„å€¼ä¸º `number` å°±å†™å…¥åˆ°å¹´é¾„ä¸­ã€‚

```typescript
interface NameType {
  name: string;
}

interface AgeType {
  age: number;
}

function createUserInfo(val: string | number): NameType | AgeType {
  if (typeof val === 'string') {
    return {
      name: val,
    };
  }
  return {
    age: val,
  };
}

const userName = createUserInfo('å¼ ä¸‰');
const userAge = createUserInfo(18);
```

å½“æˆ‘ä»¬è°ƒç”¨å‡½æ•°å†™å…¥ä¿¡æ¯æ—¶ï¼Œå¸Œæœ›ä»–çš„è¿”å›å€¼æ˜¯å¯¹åº”çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ `userName` çš„ç±»å‹ä¸º `NameType`ã€‚ä½†æ˜¯å®é™…ä¸Šï¼ŒTypeScript æ¨æ–­çš„ç±»å‹æ˜¯
![20250318141305.png](../image/20250318141305.png)
æœ‰äººè¯´è¿™æ˜¯å› ä¸ºä½ åœ¨å‡½æ•°ä¸ŠæŒ‡å®šäº†è¿”å›å€¼çš„ç±»å‹ï¼Œé‚£ä¹ˆå»æ‰å‡½æ•°çš„è¿”å›å€¼ç±»å‹
![20250318141455.png](../image/20250318141455.png)
å¦‚æœæˆ‘ä»¬æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä»¥å‰çš„æ–¹æ³•æ˜¯å†™ç±»å‹é‡è½½
![20250318141826.png](../image/20250318141826.png)
è¿™æ ·é—®é¢˜å°±è§£å†³äº†ï¼Œä½†æ˜¯è¿™æ ·çš„å†™æ³•æœ‰ä¸è¶³ä¹‹å¤„ï¼Œå¦‚æœåé¢æˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸åŒçš„ç±»å‹ï¼Œä¾‹å¦‚`boolean`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—ä¸æ–­åœ°åœ¨ä¸Šé¢æ·»åŠ æ–°çš„ç±»å‹é‡è½½ï¼Œè¿™æ ·ä»£ç å¤ªè¿‡å†—ä½™ã€‚æˆ‘ä»¬ç”¨æ¡ä»¶ç±»å‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜

![20250318142447.png](../image/20250318142447.png)
è¿™æ ·æˆ‘ä»¬å°±æŠŠå¤šè¡Œç±»å‹é‡è½½é‡æ„æˆä¸€è¡Œä»£ç ï¼Œä½¿ä»£ç æ›´åŠ ç®€ç»ƒ

### infer

`infer` æ˜¯ TypeScript ä¸­çš„æ¡ä»¶ç±»å‹æ¨æ–­å…³é”®å­—ï¼Œç”¨äºåœ¨æ¡ä»¶ç±»å‹ä¸­æå–å’Œæ¨æ–­ç±»å‹ã€‚å®ƒåªèƒ½åœ¨ `extends` æ¡ä»¶ç±»å‹çš„ `true` åˆ†æ”¯ä¸­ä½¿ç”¨ã€‚

```typescript
type ReturnType<T> = T extends (...args: any[]) => infer R ? R : any;

// ä½¿ç”¨ç¤ºä¾‹
function foo(): number {
  return 42;
}

type FooReturnType = ReturnType<typeof foo>; // number
```

## æ˜ å°„ç±»å‹

æ˜ å°„ç±»å‹æ˜¯ TypeScript ä¸­çš„ä¸€ç§é«˜çº§ç±»å‹æ„é€ æ–¹å¼ï¼Œå…è®¸ä½ åŸºäºæ—§ç±»å‹åˆ›å»ºæ–°ç±»å‹ï¼Œé€šè¿‡éå†ç°æœ‰ç±»å‹çš„å±æ€§å¹¶åº”ç”¨è½¬æ¢æ¥åˆ›å»ºæ–°çš„ç±»å‹ç»“æ„ã€‚

```typescript
type MappedType<T> = {
  [P in keyof T]: TransformedType;
};

// 1. `keyof T`Â è·å– T çš„æ‰€æœ‰å±æ€§åä½œä¸ºè”åˆç±»å‹
// 2. `P in keyof T`Â éå†è¿™äº›å±æ€§
// 3. ä¸ºæ¯ä¸ªå±æ€§åº”ç”¨è½¬æ¢ï¼Œäº§ç”Ÿæ–°çš„ç±»å‹
```

### å¸¸ç”¨æ˜ å°„ç±»å‹

#### åªè¯»ç±»å‹

`Readonly` å°†ç±»å‹çš„æ‰€æœ‰å±æ€§å˜ä¸ºåªè¯»ï¼š

```typescript
interface User {
  name: string;
  age: number;
}

type ReadonlyUser = Readonly<User>;
// ç­‰åŒäº
// {
//   readonly name: string;
//   readonly age: number;
// }
```

`Readonly` çš„å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š

```typescript
type Readonly<T> = {
  readonly [K in keyof T]: T[K];
};
```

#### å¯é€‰ç±»å‹

`Partial` å°†ç±»å‹çš„æ‰€æœ‰å±æ€§è®¾ç½®ä¸ºå¯é€‰ï¼š

```typescript
interface User {
  name: string;
  age: number;
}

type PartialUser = Partial<User>;
// ç­‰åŒäº
// {
//   name?: string;
//   age?: number;
// }
```

`Partial` çš„å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š

```typescript
type Partial<T> = {
  [P in keyof T]?: T[P];
};
```

#### Pick

`Pick` ä»ç±»å‹ä¸­é€‰æ‹©æŸäº›å±æ€§ï¼š

```typescript
interface User {
  name: string;
  age: number;
}

// ä½¿ç”¨ç¤ºä¾‹
type NameOnly = Pick<User, 'name'>;
// ç­‰åŒäº:
// {
//   name: string;
// }
```

`Pick` çš„å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š

```typescript
type Pick<T, K extends keyof T> = {
  [P in K]: T[P];
};
```

#### Record

`Record` å¯ä»¥æŠŠç±»å‹åˆ†é…ç»™æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ï¼š

```typescript
interface User {
  name: string;
  age: number;
}

// ä½¿ç”¨ç¤ºä¾‹
type UserExample = Record<'employee' | 'manager', User>;
// ç­‰åŒäº:
// {
//   employee: Person;
//   manager: Person;
// }
```

`Record` çš„å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š

```typescript
type Record<K extends keyof any, T> = {
  [P in K]: T;
};
```

ä¸Šé¢åˆ—ä¸¾å‡ºçš„æ˜¯å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„æ˜ å°„ç±»å‹ã€‚

### é«˜çº§æ˜ å°„ç±»å‹

#### æ¡ä»¶æ˜ å°„ç±»å‹

æ¡ä»¶æ˜ å°„ç±»å‹ç»“åˆæ¡ä»¶ç±»å‹å’Œæ˜ å°„ç±»å‹çš„ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°† `User` ç±»å‹ä¸­æ‰€æœ‰çš„ `string` å±æ€§è½¬æ¢ä¸º `string[]`ï¼š

```typescript
interface User {
  name: string;
  age: number;
  isActive: boolean;
}

// ä½¿ç”¨æ¡ä»¶æ˜ å°„ç±»å‹
type ExampleUser<T> = {
  [P in keyof T]: T[P] extends string ? string[] : T[P];
};

type UserExample = ExampleUser<User>;
// ç­‰åŒäº:
// {
//   name: string[];
//   age: number;
//   isActive: boolean;
// }
```

#### ä½¿ç”¨ Â `-`Â  ä¿®é¥°ç¬¦ç§»é™¤å±æ€§

æˆ‘ä»¬æœ‰ä¸€ä¸ªç±»å‹ `User`ï¼Œå®ƒé‡Œé¢çš„å±æ€§éƒ½æ˜¯åªè¯»çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å®šä¹‰ä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œè®© `User` é‡Œçš„å±æ€§ä¸å†æ˜¯åªè¯»çš„ï¼Œåœ¨ä¹‹å‰çš„è¯ï¼Œæˆ‘ä»¬åªèƒ½é‡æ–°å¤åˆ¶è¯¥ç±»å‹ï¼Œå¹¶æ‰‹åŠ¨ä¸€ä¸ªä¸ªå»æ‰ `readonly`ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ›´å¿«æ·çš„ä¿®æ”¹ç±»å‹çš„æ–¹å¼å‘¢ï¼Ÿ

```typescript
interface User {
  readonly name: string;
  readonly age: number;
}
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ˜ å°„ç±»å‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡ Â `-`Â  ä¿®é¥°ç¬¦ç§»é™¤å±æ€§
![20250318152808.png](../image/20250318152808.png)

#### ä½¿ç”¨ Â `as`Â  å­å¥é‡æ˜ å°„é”®å

æˆ‘ä»¬ç°åœ¨æƒ³æ„å»ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œä»–å¯ä»¥è·å–`User` ç±»å‹ä¸Šå±æ€§çš„å€¼ï¼Œå¹¶ä¸”å±æ€§å‘½åæ–¹å¼æŒ‰ç…§ **getXxxx** æ¥å‘½åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `as` æ¥é‡æ˜ å°„é”®å

```typescript
interface User {
  name: string;
  age: number;
  sex: boolean;
}

type GetUserType<T> = {
  [P in keyof T as `get${Capitalize<string & P>}`]: () => T[P];
};

type UserExample = GetUserType<User>;
// ç­‰åŒäº:
// {
//   getName: () => string;
//   getAge: () => number;
//   getSex: () => boolean;
// }
```

`Capitalize` å¯ä»¥å°†æˆ‘ä»¬ä¼ å…¥çš„å€¼è½¬å˜ä¸ºé¦–å­—æ¯å¤§å†™

## æ€»ç»“

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»äº† TypeScript ä¸­çš„æ¡ä»¶ç±»å‹ä¸æ˜ å°„ç±»å‹ã€‚æ¡ä»¶ç±»å‹è®©æˆ‘ä»¬å¯ä»¥æ ¹æ®ç±»å‹å…³ç³»åŠ¨æ€é€‰æ‹©ç±»å‹ï¼Œè€Œæ˜ å°„ç±»å‹æä¾›äº†å¼ºå¤§çš„å·¥å…·æ¥æ“ä½œå’Œè½¬æ¢ç±»å‹ç»“æ„ã€‚é€šè¿‡è¿™äº›ç‰¹æ€§ï¼ŒTypeScript çš„ç±»å‹ç³»ç»Ÿæ›´åŠ çµæ´»ä¸”å¼ºå¤§ï¼Œèƒ½å¤Ÿé€‚åº”å¤æ‚çš„éœ€æ±‚ã€‚

å¸Œæœ›é€šè¿‡æœ¬ç¯‡æ–‡ç« ï¼Œæ‚¨å¯¹æ¡ä»¶ç±»å‹ä¸æ˜ å°„ç±»å‹æœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œå¹¶èƒ½å¤Ÿåœ¨å®é™…å¼€å‘ä¸­çµæ´»è¿ç”¨ã€‚

å¦‚æ–‡ç« æœ‰é”™è¯¯æˆ–è€…ä¸ä¸¥è°¨çš„åœ°æ–¹ï¼ŒæœŸå¾…ç»™äºæŒ‡æ­£ï¼Œä¸‡åˆ†æ„Ÿè°¢ã€‚

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« æˆ–è€…æœ‰æ‰€å¯å‘ï¼Œæ¬¢è¿ ğŸ‘‰ [ä¸‰æ£µæ¨æ ‘](https://github.com/sankeyangshu)ï¼Œç»™ä½œè€…ä¸€äº›é¼“åŠ±å§ï¼

> æœ¬æ–‡æºæ–‡ä»¶éƒ½æ”¾åœ¨äº† Â [Github](https://github.com/sankeyangshu-labs/typescript-study)Â  ä¸Šï¼Œå¦‚æœæ‚¨è§‰å¾—æˆ‘å†™å¾—è¿˜ä¸é”™ï¼Œå¸Œæœ›æ‚¨èƒ½ç»™**â¤ï¸ è¿™ç¯‡æ–‡ç« ç‚¹èµ [Github](https://github.com/sankeyangshu-labs/typescript-study)åŠ æ˜Ÿ â¤**ï¸ å“¦~
